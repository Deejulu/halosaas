{% extends 'base.html' %}
{% block content %}
  <h2>Change your password</h2>
  <form method="post" id="password-change-form">
    {% csrf_token %}
    {{ form.as_p }}
    {% if form.errors %}
      <div class="alert alert-danger">
        <ul>
        {% for field in form %}
          {% for error in field.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
          <li>{{ error }}</li>
        {% endfor %}
        </ul>
      </div>
    {% endif %}
    <button type="submit" id="submit-btn">Change password</button>
    <span id="loading-indicator" style="display:none; margin-left:10px; color:#007bff;">Changing...</span>
  </form>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var form = document.getElementById('password-change-form');
      var btn = document.getElementById('submit-btn');
      var loading = document.getElementById('loading-indicator');
      form.addEventListener('submit', function() {
        btn.disabled = true;
        loading.style.display = 'inline';
      });
    });
  </script>
{% endblock %}
